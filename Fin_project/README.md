# Матчинг товаров на основе изображений и/или текстовых описаний

## Схема матчинга
Матчинг товаров представляет собой процесс сопоставления объектов (карточек товаров) на основе сравнения и расчета некоторой меры схожести, где первый объект представляет запрос, а другой - базу данных с объектами (см. рис ниже).

![image](https://github.com/user-attachments/assets/c7002f41-b044-4c4c-b24d-1e946b238032)

В рамках данного проекта будут исследованы варианты матчинга до стадии выдачи TOP N похожих объектов, так как попарное сравнение уже требует дополнительной разметки.

## Задачи проекта
Данный проект носит исследовательский характер и решает следующие задачи:
- изучить варианты эмбедингов для отбора похожих товаров на основе карточек товаров
- сравнить тектстовые и картиночные эмбединги, а также объединение этих модальностей
- проверить, улучшает ли качество эмбедингов fine-tune моделей, используемых для создания эмбедингов

## Данные
Для проекта были собраны карточки товаров включая изображение у 6 продавцов спортивного снаряжения как представлено на схеме ниже. Для сбора использовались парсеры, собранные вот в этой [папке](https://github.com/shakhovak/CV_OTUS_course/tree/master/Fin_project/parcers). В качестве данных компании (т.е. объектов, для которых будут находиться top N) используются карточки товаров SportDoma. Все остальные карточки относятся к базе данных, в рамках которой производится поиск матчей для карточек компании.

![image](https://github.com/user-attachments/assets/997640bc-0c19-4a1c-b418-67f41eea99f6)

Собранные данные содержат следующую информацию:

- текст
   - **title** - название товара, указанное продавцом
   - **price** - цена товара, указанная продавцов
   - **cat_1, cat_2, cat_3** - категории иерархии товаров, выбранные продавцом для магазина
   - **carachteristics** - описание характеристик товара (свободный текстовый формат)
   - **img_ref** - путь к файлу с изображением товара
   - **target** - категория товара, используемая для матчинга (в большинтсве случаев совпадает с  cat_2 или cat_3)
   - **dealer** - краткое название продавца
- изображение - изображение товара из карточки (выбранное продавцом в качестве основного/первого). Примеры изображений по категориям на рис ниже - видно, что изображения в разных размреностях.

![image](https://github.com/user-attachments/assets/3241469d-4107-4be8-b8cb-429bfbfe7efb)

Собранная информация была предобработана для создания финальных файлов, используемых в проекте (см. [папку](https://github.com/shakhovak/CV_OTUS_course/tree/master/Fin_project/data)): файл ```company_data.csv ``` (итого ~ 1тыс позиций) включает информацию о данных товаров Sportdoma, файл ```comparable_data.csv ``` (итого ~ 13,5 тыс. позиций) включает информацию о карточках товаров, используемыз в качестве базы данных.

Предообработка включает :
- удаление строк, где не скачался файл с изображением товара
- удаление лишних символов в текстах и нормализация по unicode



## Модели и подходы

## Эксперименты

## Оценка результатов

## Структура репозитория

## Выводы
